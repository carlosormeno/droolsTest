<p>client-simulator works!</p>
<div class="simulator-container">
  <div class="header-section">
    <h1>
      <mat-icon>person_search</mat-icon>
      Simulador de Clientes
    </h1>
    <p>Crea clientes de prueba y ejecuta reglas en tiempo real</p>
  </div>

  <div class="content-tabs">
    <mat-tab-group>
      <mat-tab label="Simulación">
        <div class="tab-content">
          <div class="simulator-grid">
            <!-- Formulario de Cliente -->
            <mat-card class="customer-form-card">
              <mat-card-header>
                <mat-card-title>
                  <mat-icon>person_add</mat-icon>
                  Crear Cliente de Prueba
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <form (ngSubmit)="simulateCustomer()" class="customer-form">
                  <div class="form-row">
                    <mat-form-field appearance="outline" class="full-width">
                      <mat-label>Nombre Completo</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.name"
                             name="name"
                             placeholder="Ej: María González"
                             required>
                      <mat-icon matSuffix>person</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="form-row">
                    <mat-form-field appearance="outline" class="full-width">
                      <mat-label>Email</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.email"
                             name="email"
                             type="email"
                             placeholder="maria@ejemplo.com"
                             required>
                      <mat-icon matSuffix>email</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="form-row-double">
                    <mat-form-field appearance="outline">
                      <mat-label>Edad</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.age"
                             name="age"
                             type="number"
                             min="1" max="120"
                             placeholder="30">
                      <mat-icon matSuffix>cake</mat-icon>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Compras Totales ($)</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.totalPurchases"
                             name="totalPurchases"
                             type="number"
                             min="0"
                             placeholder="5000">
                      <mat-icon matSuffix>shopping_cart</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="form-row-double">
                    <mat-form-field appearance="outline">
                      <mat-label>Puntos de Lealtad</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.loyaltyPoints"
                             name="loyaltyPoints"
                             type="number"
                             min="0"
                             placeholder="500">
                      <mat-icon matSuffix>loyalty</mat-icon>
                    </mat-form-field>

                    <mat-form-field appearance="outline">
                      <mat-label>Días desde Registro</mat-label>
                      <input matInput
                             [(ngModel)]="testCustomer.daysSinceRegistration"
                             name="daysSinceRegistration"
                             type="number"
                             min="0"
                             placeholder="30">
                      <mat-icon matSuffix>schedule</mat-icon>
                    </mat-form-field>
                  </div>

                  <div class="checkbox-section">
                    <mat-checkbox [(ngModel)]="testCustomer.isActive" name="isActive">
                      Cliente Activo
                    </mat-checkbox>
                  </div>

                  <div class="button-section">
                    <button mat-raised-button
                            color="primary"
                            type="submit"
                            [disabled]="loading">
                      <span *ngIf="loading">
                        <mat-spinner diameter="20"></mat-spinner>
                      </span>
                      <mat-icon *ngIf="!loading">play_arrow</mat-icon>
                      {{ loading ? 'Ejecutando...' : 'Ejecutar Reglas' }}
                    </button>

                    <button mat-button
                            type="button"
                            (click)="generateRandomCustomer()"
                            [disabled]="loading">
                      <mat-icon>shuffle</mat-icon>
                      Cliente Aleatorio
                    </button>

                    <button mat-button
                            color="accent"
                            type="button"
                            (click)="resetForm()"
                            [disabled]="loading">
                      <mat-icon>refresh</mat-icon>
                      Limpiar
                    </button>
                  </div>
                </form>
              </mat-card-content>
            </mat-card>

            <!-- Resultados -->
            <div class="results-section">
              <app-simulation-results
                [result]="lastResult"
                [scenarioName]="scenarioName"
                (saveScenario)="saveScenario()"
                (scenarioNameChange)="scenarioName = $event">
              </app-simulation-results>
            </div>
          </div>
        </div>
      </mat-tab>

      <mat-tab label="Escenarios Guardados">
        <div class="tab-content">
          <mat-card class="scenarios-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>bookmark</mat-icon>
                Escenarios de Prueba ({{ scenarios.length }})
              </mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <div class="scenarios-list" *ngIf="scenarios.length > 0">
                <div *ngFor="let scenario of scenarios" class="scenario-item">
                  <div class="scenario-info">
                    <h4>{{ scenario.name }}</h4>
                    <p class="scenario-details">
                      <mat-icon>person</mat-icon>
                      {{ scenario.customer.name }} ({{ scenario.customer.age }} años)
                    </p>
                    <p class="scenario-details">
                      <mat-icon>attach_money</mat-icon>
                      ${{ scenario.customer.totalPurchases }} en compras
                    </p>
                    <p class="scenario-details">
                      <mat-icon>schedule</mat-icon>
                      {{ scenario.createdAt | date:'short' }}
                    </p>
                  </div>
                  <div class="scenario-actions">
                    <button mat-icon-button
                            color="primary"
                            (click)="loadScenario(scenario)"
                            matTooltip="Ejecutar escenario">
                      <mat-icon>play_arrow</mat-icon>
                    </button>
                    <button mat-icon-button
                            color="warn"
                            (click)="deleteScenario(scenario.id)"
                            matTooltip="Eliminar escenario">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </div>
              </div>

              <div *ngIf="scenarios.length === 0" class="empty-scenarios">
                <mat-icon class="empty-icon">bookmark_border</mat-icon>
                <h3>No hay escenarios guardados</h3>
                <p>Ejecuta una simulación y guárdala como escenario para reutilizarla</p>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
